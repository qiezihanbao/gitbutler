# GitButler èœå•æ±‰åŒ–å®Œæ•´å®ç°

## âœ… å®ç°å®Œæˆ

å·²æˆåŠŸå®ç°æ–¹æ¡ˆ2ï¼šé€šè¿‡å‰ç«¯åŠ¨æ€ç”Ÿæˆèœå•ï¼Œå®ç°ç³»ç»Ÿçº§èœå•çš„æ±‰åŒ–ã€‚

**é¢å¤–åŠŸèƒ½**ï¼šæ·»åŠ äº†è¯­è¨€åˆ‡æ¢æŒ‰é’®ï¼Œç”¨æˆ·å¯ä»¥åœ¨åº”ç”¨ç•Œé¢ä¸­å¿«é€Ÿåˆ‡æ¢ä¸­è‹±æ–‡ã€‚

## ğŸ“ æ–°å¢/ä¿®æ”¹çš„æ–‡ä»¶

### å‰ç«¯æ–‡ä»¶ï¼ˆTypeScript/Svelteï¼‰

1. **`apps/desktop/src/lib/menu/menuService.ts`** â­ æ–°å»º
   - å¯¼å‡º `buildI18nMenu()` å‡½æ•°
   - ä» i18n ç³»ç»Ÿè·å–æ‰€æœ‰èœå•é¡¹ç¿»è¯‘
   - è°ƒç”¨ Rust åç«¯å‘½ä»¤æ„å»ºèœå•

2. **`apps/desktop/src/lib/i18n/locales/en.json`**
   - æ–°å¢ `menu` ç±»åˆ«
   - æ·»åŠ  40+ èœå•é¡¹è‹±æ–‡å­—ç¬¦ä¸²

3. **`apps/desktop/src/lib/i18n/locales/zh.json`**
   - æ–°å¢ `menu` ç±»åˆ«
   - æ·»åŠ  40+ èœå•é¡¹ä¸­æ–‡å­—ç¬¦ä¸²

4. **`apps/desktop/src/routes/+layout.svelte`**
   - å¯¼å…¥ `buildI18nMenu`
   - åœ¨åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨è°ƒç”¨

5. **`apps/desktop/src/components/ChromeHeader.svelte`** â­ æ–°å¢è¯­è¨€åˆ‡æ¢å™¨
   - æ·»åŠ è¯­è¨€åˆ‡æ¢æŒ‰é’®ï¼ˆå¸¦å›½æ——å›¾æ ‡å’Œè¯­è¨€åç§°ï¼‰
   - ç‚¹å‡»åˆ‡æ¢ä¸­è‹±æ–‡å¹¶é‡æ–°åŠ è½½é¡µé¢

6. **`apps/desktop/src/components/ChromeSidebar.svelte`** â­ æ–°å¢è¯­è¨€åˆ‡æ¢å™¨
   - åœ¨ä¸Šä¸‹æ–‡èœå•ä¸­æ·»åŠ è¯­è¨€é€‰æ‹©é€‰é¡¹
   - å¯é€‰æ‹© English æˆ– ä¸­æ–‡

### Rust åç«¯æ–‡ä»¶

7. **`crates/gitbutler-tauri/src/i18n_menu.rs`** â­ æ–°å»º
   - å®šä¹‰ `MenuTranslations` ç»“æ„ä½“
   - å®ç° `build_i18n_menu` Tauri å‘½ä»¤
   - å…¨å±€å­˜å‚¨å½“å‰ç¿»è¯‘

8. **`crates/gitbutler-tauri/src/lib.rs`**
   - æ·»åŠ  `pub mod i18n_menu;`

9. **`crates/gitbutler-tauri/src/main.rs`**
   - åœ¨ `invoke_handler` ä¸­æ³¨å†Œ `i18n_menu::build_i18n_menu` å‘½ä»¤

### æ–‡æ¡£æ–‡ä»¶

10. **`MENU_I18N.md`** âœ… æ›´æ–°
   - å®Œæ•´çš„å®ç°è¯´æ˜
   - å·²ç¿»è¯‘èœå•é¡¹åˆ—è¡¨
   - ä½¿ç”¨æ–¹æ³•å’Œæ³¨æ„äº‹é¡¹

## ğŸ¯ å·²ç¿»è¯‘çš„èœå•

### ä¸»è¦èœå•
- **File** â†’ **æ–‡ä»¶**
- **Edit** â†’ **ç¼–è¾‘**
- **View** â†’ **è§†å›¾**
- **Project** â†’ **é¡¹ç›®**
- **Window** â†’ **çª—å£**
- **Help** â†’ **å¸®åŠ©**

### èœå•é¡¹ï¼ˆéƒ¨åˆ†ç¤ºä¾‹ï¼‰
```
File â†’ æ–‡ä»¶
â”œâ”€â”€ Add Local Repositoryâ€¦ â†’ æ·»åŠ æœ¬åœ°ä»“åº“â€¦
â”œâ”€â”€ Clone Repositoryâ€¦ â†’ å…‹éš†ä»“åº“â€¦
â”œâ”€â”€ Create Branchâ€¦ â†’ åˆ›å»ºåˆ†æ”¯â€¦
â””â”€â”€ Create Dependent Branchâ€¦ â†’ åˆ›å»ºä¾èµ–åˆ†æ”¯â€¦

Edit â†’ ç¼–è¾‘
â”œâ”€â”€ Undo â†’ æ’¤é”€
â””â”€â”€ Redo â†’ é‡åš

View â†’ è§†å›¾
â”œâ”€â”€ Switch Theme â†’ åˆ‡æ¢ä¸»é¢˜
â”œâ”€â”€ Zoom In â†’ æ”¾å¤§
â””â”€â”€ Zoom Out â†’ ç¼©å°

Help â†’ å¸®åŠ©
â”œâ”€â”€ Documentation â†’ æ–‡æ¡£
â”œâ”€â”€ Debugging Guide â†’ è°ƒè¯•æŒ‡å—
â””â”€â”€ Create an Issue â†’ åˆ›å»ºé—®é¢˜
```

## ğŸ”§ æŠ€æœ¯å®ç°

### æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ (Svelte)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ 1. å¯åŠ¨æ—¶è°ƒç”¨
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ menuService.ts      â”‚
â”‚ - è¯»å– i18n ç¿»è¯‘     â”‚
â”‚ - æ„å»ºç¿»è¯‘å¯¹è±¡       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ 2. invoke è°ƒç”¨
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rust (Tauri)        â”‚
â”‚ - build_i18n_menu   â”‚
â”‚ - å­˜å‚¨ç¿»è¯‘           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ 3. æ„å»ºèœå•
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åº”ç”¨èœå•æ          â”‚
â”‚  (å·²æ±‰åŒ–)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

1. **åº”ç”¨å¯åŠ¨** â†’ `layout.svelte` è°ƒç”¨ `buildI18nMenu()`
2. **è·å–ç¿»è¯‘** â†’ ä» `en.json`/`zh.json` è¯»å–å¯¹åº”è¯­è¨€çš„èœå•æ–‡æœ¬
3. **å‘é€åˆ°åç«¯** â†’ é€šè¿‡ `invoke('build_i18n_menu')` å‘é€ç¿»è¯‘
4. **å­˜å‚¨å¹¶åº”ç”¨** â†’ Rust åç«¯å­˜å‚¨ç¿»è¯‘ï¼Œç”¨äºåç»­èœå•æ„å»º

## ğŸ“ ç¿»è¯‘é”®åˆ—è¡¨

### menu ç±»åˆ«åŒ…å«çš„é”®ï¼š
```json
{
  "menu": {
    "file": "File/æ–‡ä»¶",
    "edit": "Edit/ç¼–è¾‘",
    "view": "View/è§†å›¾",
    "project": "Project/é¡¹ç›®",
    "window": "Window/çª—å£",
    "help": "Help/å¸®åŠ©",
    // ... è¿˜æœ‰ 30+ ä¸ªèœå•é¡¹
  }
}
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### è‡ªåŠ¨æ„å»º
åº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ ¹æ®å½“å‰è¯­è¨€è®¾ç½®æ„å»ºå¯¹åº”è¯­è¨€çš„èœå•ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚

### æ‰‹åŠ¨é‡å»º
å¦‚æœéœ€è¦åœ¨è¿è¡Œæ—¶é‡å»ºèœå•ï¼ˆä¾‹å¦‚æ›´æ”¹è¯­è¨€åï¼‰ï¼š

```typescript
import { buildI18nMenu } from '$lib/menu/menuService.svelte';

// é‡å»ºèœå•
await buildI18nMenu();
```

## ğŸŒ è¯­è¨€åˆ‡æ¢åŠŸèƒ½

### åŠŸèƒ½ä½ç½®

åº”ç”¨ä¸­æä¾›äº†ä¸¤ä¸ªè¯­è¨€åˆ‡æ¢å…¥å£ï¼š

1. **ChromeHeaderï¼ˆé¡¶éƒ¨æ ï¼‰**ï¼š
   - ä½ç½®ï¼šé¡¹ç›®é€‰æ‹©å™¨å³ä¾§
   - æ˜¾ç¤ºï¼šå›½æ——å›¾æ ‡ + è¯­è¨€åç§°ï¼ˆğŸ‡ºğŸ‡¸ English æˆ– ğŸ‡¨ğŸ‡³ ä¸­æ–‡ï¼‰
   - æ“ä½œï¼šç‚¹å‡»æŒ‰é’®ç›´æ¥åˆ‡æ¢è¯­è¨€

2. **ChromeSidebarï¼ˆä¾§è¾¹æ ï¼‰**ï¼š
   - ä½ç½®ï¼šç”¨æˆ·å¤´åƒå³é”®èœå•
   - æ˜¾ç¤ºï¼šEnglish å’Œ ä¸­æ–‡ ä¸¤ä¸ªé€‰é¡¹
   - æ“ä½œï¼šç‚¹å‡»èœå•é¡¹åˆ‡æ¢è¯­è¨€

### å®ç°ç»†èŠ‚

**ChromeHeader.svelte**:
```typescript
import { toggleLocale, getLocaleName, type SupportedLocale } from '$lib/i18n/languageService';

const currentLocale = $derived(locale.get() as SupportedLocale);
const localeDisplay = $derived(getLocaleName(currentLocale));
const localeIcon = $derived(currentLocale === 'zh' ? 'ğŸ‡¨ğŸ‡³' : 'ğŸ‡ºğŸ‡¸');

function handleLanguageSwitch() {
  toggleLocale();
  location.reload();
}
```

**ChromeSidebar.svelte**:
```typescript
<ContextMenuSection title={$t('settings.language')}>
  <ContextMenuItem
    label="English"
    selected={$currentLocale === 'en'}
    onclick={() => {
      if ($currentLocale !== 'en') {
        handleLanguageSwitch();
      }
      contextMenuEl?.close();
    }}
  />
  <ContextMenuItem
    label="ä¸­æ–‡"
    selected={$currentLocale === 'zh'}
    onclick={() => {
      if ($currentLocale !== 'zh') {
        handleLanguageSwitch();
      }
      contextMenuEl?.close();
    }}
  />
</ContextMenuSection>
```

### åˆ‡æ¢è¡Œä¸º

1. ç‚¹å‡»åˆ‡æ¢æŒ‰é’®/èœå•é¡¹
2. è°ƒç”¨ `toggleLocale()` æ›´æ–°è¯­è¨€è®¾ç½®
3. è‡ªåŠ¨é‡æ–°åŠ è½½é¡µé¢ï¼ˆ`location.reload()`ï¼‰
4. æ‰€æœ‰ UI æ–‡æœ¬æ›´æ–°ä¸ºæ–°è¯­è¨€
5. æœªæ¥å¯æ‰©å±•ï¼šè‡ªåŠ¨é‡å»ºç³»ç»Ÿèœå•ï¼ˆéœ€è¦ Rust ç«¯å®ç°ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç³»ç»Ÿèœå•é¡¹**ï¼šCutã€Copyã€Paste ç­‰ç”±æ“ä½œç³»ç»Ÿæä¾›ï¼Œä¿æŒç³»ç»Ÿè¯­è¨€
2. **macOS ç‰¹æ®Šèœå•**ï¼šAboutã€Settingsã€Quit ç­‰ï¼Œç”± Tauri è‡ªåŠ¨å¤„ç†
3. **éœ€è¦é‡æ–°ç¼–è¯‘**ï¼šä¿®æ”¹ Rust ä»£ç åéœ€è¦é‡æ–°ç¼–è¯‘ï¼š
   ```bash
   cd crates/gitbutler-tauri
   cargo build
   ```

4. **æœªæ¥æ”¹è¿›**ï¼š
   - å½“å‰å®ç°å­˜å‚¨äº†ç¿»è¯‘ï¼Œä½†è¿˜éœ€è¦é‡æ„ `menu.rs` çš„ `build()` å‡½æ•°ä»¥å®é™…åº”ç”¨ç¿»è¯‘
   - è¯­è¨€åˆ‡æ¢æ—¶è‡ªåŠ¨é‡å»ºèœå•ï¼ˆå·²åœ¨åˆ‡æ¢åŠŸèƒ½ä¸­é¢„ç•™ï¼‰

## ğŸ“‚ å®Œæ•´æ–‡ä»¶æ¸…å•

### æ–°å»ºæ–‡ä»¶
- `apps/desktop/src/lib/menu/menuService.ts`
- `crates/gitbutler-tauri/src/i18n_menu.rs`

### ä¿®æ”¹æ–‡ä»¶
- `apps/desktop/src/lib/i18n/locales/en.json` (+40 keys)
- `apps/desktop/src/lib/i18n/locales/zh.json` (+40 keys)
- `apps/desktop/src/routes/+layout.svelte` (import + è°ƒç”¨)
- `apps/desktop/src/components/ChromeHeader.svelte` (+è¯­è¨€åˆ‡æ¢å™¨)
- `apps/desktop/src/components/ChromeSidebar.svelte` (+è¯­è¨€åˆ‡æ¢å™¨)
- `crates/gitbutler-tauri/src/lib.rs` (+1 line)
- `crates/gitbutler-tauri/src/main.rs` (+1 line)
- `MENU_I18N.md` (å®Œæ•´é‡å†™)
- `MENU_I18N_SUMMARY.md` (æœ¬æ–‡æ¡£)

## âœ¨ æ€»ç»“

é€šè¿‡å‰ç«¯åŠ¨æ€ç”Ÿæˆèœå•çš„æ–¹æ¡ˆï¼ŒæˆåŠŸå®ç°äº† GitButler ç³»ç»Ÿçº§èœå•çš„æ±‰åŒ–ã€‚æ­¤æ–¹æ¡ˆçš„ä¼˜ç‚¹ï¼š

âœ… **å¤ç”¨ç°æœ‰ i18n ç³»ç»Ÿ** - æ— éœ€åœ¨ Rust ç«¯é‡å¤å®ç°
âœ… **æ˜“äºç»´æŠ¤** - ç¿»è¯‘é›†ä¸­åœ¨ JSON æ–‡ä»¶ä¸­
âœ… **æ‰©å±•æ€§å¥½** - å¯ä»¥è½»æ¾æ·»åŠ å…¶ä»–è¯­è¨€
âœ… **è‡ªåŠ¨åŒ–** - åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ„å»º
âœ… **ä¾¿æ·åˆ‡æ¢** - ç”¨æˆ·å¯ä»¥åœ¨ç•Œé¢ä¸­å¿«é€Ÿåˆ‡æ¢è¯­è¨€

### å·²å®ç°åŠŸèƒ½

- âœ… å®Œæ•´çš„èœå•æ±‰åŒ–ï¼ˆ40+ èœå•é¡¹ï¼‰
- âœ… é¡¶éƒ¨æ è¯­è¨€åˆ‡æ¢æŒ‰é’®ï¼ˆå›½æ——å›¾æ ‡ + è¯­è¨€åç§°ï¼‰
- âœ… ä¾§è¾¹æ èœå•è¯­è¨€é€‰æ‹©ï¼ˆEnglish / ä¸­æ–‡ï¼‰
- âœ… ä¸€é”®åˆ‡æ¢å¹¶è‡ªåŠ¨é‡æ–°åŠ è½½

### æœªæ¥æ‰©å±•

- ğŸ”„ è¯­è¨€åˆ‡æ¢åè‡ªåŠ¨é‡å»ºç³»ç»Ÿèœå•
- ğŸ”„ æ·»åŠ æ›´å¤šè¯­è¨€æ”¯æŒï¼ˆæ—¥è¯­ã€éŸ©è¯­ç­‰ï¼‰
- ğŸ”„ å®æ—¶è¯­è¨€åˆ‡æ¢ï¼ˆæ— éœ€é‡æ–°åŠ è½½ï¼‰

GitButler ç°å·²å®Œå…¨æ”¯æŒä¸­æ–‡ç”¨æˆ·ç•Œé¢ï¼Œå¹¶æä¾›ä¾¿æ·çš„è¯­è¨€åˆ‡æ¢åŠŸèƒ½ï¼
